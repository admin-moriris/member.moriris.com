<!-- index.html の下部スクリプトだけ置き換え -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://sqwyfscumunyhsvsvejv.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3lmc2N1bXVueWhzdnN2ZWp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0ODM4NDQsImV4cCI6MjA3NzA1OTg0NH0.P_6eP5E_Du82IEI1gzn4PKQjnqlVGoptmZZR9aIiXNU";
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
    auth: { persistSession: true, autoRefreshToken: true }
  });

  const msg = document.getElementById('msg');

  document.getElementById('login').onclick = async () => {
    msg.textContent = "送信中…";
    const email = document.getElementById('email').value.trim();
    if (!email) { msg.textContent = "メールを入力してください"; return; }

    const { data, error } = await sb.auth.signInWithOtp({
      email,
      options: { emailRedirectTo: "https://member.moriris.com/members.html" }
    });

    console.log('signInWithOtp result:', { data, error });
    msg.textContent = error ? `送信失敗: ${error.message} (status ${error.status||''})` : "メールを確認してください。";
  };

  document.getElementById('to-members').onclick = () => location.href = './members.html';
</script>
